(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==typeof e?e:String(e)}function _toPrimitive(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){let t=function(){function t(t){this.setBrand(t)}var e=t.prototype;return e.init=function(){return this._loadBrandLikes(),this},e.setBrand=function(t){this.brandId=t.brandCod,this.name=t.name,this.ready=!1,this.tooltipModel={text:""}},e.update=function(t){this.setBrand(t),this._loadBrandLikes()},e.destroy=function(){return this},e.voteForBrand=function(){const t=this.alreadyVoted;(t?this._unvoteBrand():this._voteBrand()).then(e=>{$.observable(this).setProperty({alreadyVoted:!this.alreadyVoted,votesCount:e.voteCount,"tooltipModel.text":t?"Добавить в любимые бренды":"Удалить из любимых брендов"})}).catch(t=>{t.isUnauthorize})},e._voteBrand=function(){return this.$analitic.sendEvent("BrandPage_AddFavourite_T",{name:this.name}),this.$httpClient.fetchJSON("/webapi/lk/favorites/brand/addbyid",{method:"POST",body:new URLSearchParams({brandId:this.brandId})},{redirectUnauth:!0})},e._unvoteBrand=async function(){return this.$analitic.sendEvent("BrandPage_RemoveFavourite_T",{name:this.name}),{voteCount:await this.$httpClient.fetchJSON("/webapi/lk/favorites/brand/removebyid",{method:"POST",body:new URLSearchParams({brandId:this.brandId})},{redirectUnauth:!0})}},e._loadBrandLikes=async function(){try{var t;const{alreadyVoted:e,...r}=null!==(t=await this.$httpClient.fetchJSON("/webapi/favorites/brand/getvotesbyid",{method:"POST",body:new URLSearchParams({brandId:this.brandId})}))&&void 0!==t?t:{};if(null==r)return void console.warn(`Didn\`t get votes info for brand ${this.name}`);$.observable(this).setProperty({ready:!0,alreadyVoted:e,"tooltipModel.text":e?"Удалить из любимых брендов":"Добавить в любимые бренды",...r})}catch(t){console.error(t.message)}},_createClass(t,[{key:"template",get:function(){return $.views.templates.catalogBrandLikes}}]),t}();window.__spaModuleManager__.register("catalogBrandLikes",t)}();

},{}]},{},[1]);
