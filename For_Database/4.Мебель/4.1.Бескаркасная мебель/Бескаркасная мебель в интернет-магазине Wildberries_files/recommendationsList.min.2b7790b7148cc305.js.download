(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _inheritsLoose(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,_setPrototypeOf(t,o)}function _setPrototypeOf(t,o){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t})(t,o)}!function(){let t=function(t){function o(o={}){var e;return(e=t.call(this)||this).settings=o,e}_inheritsLoose(o,t);var e=o.prototype;return e.loadGoodsAsync=async function(){const t=await this._loadNmsAsync();return{goods:await wb.xnm.getGoodsForRecommendAndCatalog(t,!0)}},e._loadNmsAsync=function(){return fetch("/webapi/goods/visited-nm",{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.json()).then(t=>new Promise((o,e)=>{$.processResponse(t,t=>{o(t.nmsArr)},t=>{console.error(t),e()})}))},o}(WbSpaModel);module.exports=t}();

},{}],2:[function(require,module,exports){
"use strict";function _inheritsLoose(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t,_setPrototypeOf(t,s)}function _setPrototypeOf(t,s){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t})(t,s)}!function(){let t=function(t){function s(s={},o){var e;return(e=t.call(this)||this).settings=s,e.isDynamic=o,e}_inheritsLoose(s,t);var o=s.prototype;return o.fillGoodsAsync=async function(t,s){t=t.map(t=>({cod1S:t}));try{return await wb.xnm.fillPrice(t,void 0),t.filter(t=>t.price>0)}catch(t){return s}},o.loadGoodsAsync=async function(){return Array.isArray(this.settings.products)?{goods:this.settings.products}:this.settings.byNms?this._loadGoodsByNmsAsync():this.settings.isFinishLook?this._loadGoodsFinishLook():"function"==typeof this.settings.loadItemsCustom?this.settings.loadItemsCustom(this.settings):this.settings.isPromo?this._loadPromoGoods():this.settings.fetchUrl?this._loadGoodsByUrl():this.settings.isSimilarByNm?this._loadSimilarByNmFromPublic():this.settings.isSimilarByRecent?this._loadSimilarByRecent():this.settings.isRecommendedByNm?this._loadRecommendedByNm():this.settings.isAlsoBuyByNm?this._loadAlsoBuyByNm():this.settings.xData?this._loadGoodsFromCatalog():await this._loadGoodsDefault()},o._loadGoodsByNmsAsync=async function(){const t=await this._loadNmsAsync();return t&&0!=t.length?(await wb.xnm.getGoodsForRecommendAndCatalog(t)).filter(t=>null!=t.name):null},o._loadGoodsFinishLook=async function(){var t;let s=null;if(this.settings.fetchUrl){var o,e,i,n;const t=await this.$httpClient.fetchBasicJSON(this.settings.fetchUrl,{method:null!==(o=this.settings.httpMethod)&&void 0!==o?o:"GET"},{nullOnError:!0,timeout:3e3}),r=null==t||null===(e=t.params)||void 0===e||null===(e=e.curr)||void 0===e?void 0:e.toUpperCase(),a=null==t||null===(i=t.params)||void 0===i?void 0:i.spp;s=null==t||null===(n=t.data)||void 0===n||null===(n=n.products)||void 0===n?void 0:n.map(t=>(t.currency=r,t.spp=a,wb.xnm.convertXProductToRecommendationProduct(t)))}else{if(void 0===this.settings.nmIds||0===this.settings.nmIds.length)return null;s=await wb.xnm.getGoodsForRecommendAndCatalog(this.settings.nmIds.slice(0,100))}return(null===(t=s)||void 0===t?void 0:t.length)<7?null:{goods:s}},o._loadPromoGoods=async function(){try{const t=this.settings.query.nmId,s=await this.$httpClient.fetchJSON(`https://carousel-ads.wildberries.ru/api/v4/carousel?nm=${t}`,{headers:{"Wb-AppType":"1"},credentials:"omit"},{noProcessResponse:!0});if((null==s?void 0:s.length)>0){const t=s.map(t=>t.nmId);this.settings.advertCarouselStatParams=s,this.settings.productId=this.settings.query.nmId;const o=await wb.xnm.getGoodsForRecommendAndCatalog(t);return(null==o?void 0:o.length)>0?{goods:o}:null}}catch(t){return console.error("can't load goods"),null}},o._loadGoodsByUrl=async function(){var t;let s=null;const o=new URL(this.settings.fetchUrl,window.location.origin);this.settings.query&&Object.keys(this.settings.query).forEach(t=>o.searchParams.append(t,this.settings.query[t]));const e=await this.$analitic.getSplitterHeaders(),i={};0===this.settings.fetchUrl.indexOf("https")&&(i.noProcessResponse=!0);const n=await this.$httpClient.fetchJSON(o.toString(),{method:null!==(t=this.settings.httpMethod)&&void 0!==t?t:"GET",headers:e},i),r=n.nmIds||Array.isArray(n)&&n;return r&&(s=await wb.xnm.getGoodsForRecommendAndCatalog(r)),{goods:s}},o._loadGoodsDefault=async function(){return this.$httpClient.fetchJSON("/webapi/recommendations/providers")[0]},o._loadNmsAsync=async function(){return(await this.$httpClient.fetchJSON("/webapi/recommendations/providers",{method:"POST",body:this.$helper.objectSerializer({recommendations:[{location:this.settings.type,markupBlock:this.settings.markupBlock,orderedGoodsIds:this.settings.nmIds}]})}))[0]},o._loadSimilarByRecent=async function(){var t;const s=this.$recentViews.get(),o=await this.$user.getUserInfo();if((null==s||null===(t=s.nm)||void 0===t?void 0:t.length)>0){const t=await this.$httpClient.fetchJSON(`https://in-comp.wildberries.ru/basket?nm=${s.nm.slice(0,10).join(",")}&limit=100`,{credentials:"omit",headers:{UserID:o.uid}},{noProcessResponse:!0});return Array.isArray(t)&&0!==t.length?{goods:await wb.xnm.getGoodsForRecommendAndCatalog(t.slice(0,100))}:null}return null},o._loadSimilarByNmFromPublic=async function(){const t=await this.$analitic.getSplitterHeaders(),s=await this.$httpClient.fetchJSON(`https://in-similar.wildberries.ru/?nm=${this.settings.query.nmId}`,{credentials:"omit",headers:t},{noProcessResponse:!0});return Array.isArray(s)&&0!==s.length?this.isDynamic?{nms:s}:{goods:await wb.xnm.getGoodsForRecommendAndCatalog(s.slice(0,100))}:null},o._getDigitalService=async function(t){return null!=t&&t.length&&"RUB"===this.$user.getCurrency()&&"ru"===this.$user.getLocale()?(await this.$moduleLoader.loadServiceAsync("digitalServicesService"),await this.$services.digitalServicesService.getServiceById(t[0])):null},o._loadRecommendedByNm=async function(){var t;const s=await this.$analitic.getSplitterHeaders(),o=await this.$httpClient.fetchBasicJSON(`https://rec-goods.wildberries.ru/api/v1/recommendations?nm=${this.settings.query.nmId}`,{credentials:"omit",headers:s});if(o&&(o.nmIds=o.nms),!o||null===(t=o.nmIds)||void 0===t||!t.length)return null;const[e,i]=await Promise.all([this._getDigitalService(o.services),wb.xnm.getGoodsForRecommendAndCatalog(o.nmIds)]);return null!=i&&i.length?{goods:e?[e].concat(i):i,serviceCard:e}:null},o._loadAlsoBuyByNm=async function(){let t=null;const s=await this.$analitic.getSplitterHeaders(),o=await this.$httpClient.fetchBasicJSON(`https://in-comp.wildberries.ru/?nm=${this.settings.query.nmId}`,{credentials:"omit",headers:s});return(null==o?void 0:o.length)>0&&(t=await wb.xnm.getGoodsForRecommendAndCatalog(o.slice(0,100))),{goods:t}},o._loadGoodsFromCatalog=async function(){let t=null;try{var s;const[o,e]=await Promise.all([this.$moduleLoader.loadModuleAsync("xCatalogGoodsLoader"),this.$getCurrentXInfoAsync()]),i=await o.loadGoodsAsync(e,this.settings.xData,new URLSearchParams),n=null==i||null===(s=i.data)||void 0===s?void 0:s.products;(Array.isArray(n)||0===n.length)&&(t=n.map(t=>wb.xnm.convertXProductToSpaCatalogProductV2(t)))}catch(t){console.error(t)}finally{return{goods:t}}},s}(WbSpaModel),s=function(t){function s(s={},o={}){var e,i,n;return(n=t.call(this,s,!0)||this).nms=[],n.goods=[],n.sizeForStaticGoods=null!==(e=o.sizeForStaticGoods)&&void 0!==e?e:16,n.sizeForDynamicGoods=null!==(i=o.sizeForDynamicGoods)&&void 0!==i?i:8,n.nmIdsLoaded=!1,n.currentIdx=0,n.chunkSize=100,n.currentChunk=1,n.goodsChunksCache=new Map,n.checkedNmCount=0,n}_inheritsLoose(s,t);var o=s.prototype;return o.loadGoodsAsync=async function(){const t=this.nmIdsLoaded?this.sizeForDynamicGoods:this.sizeForStaticGoods,s=await this._getGoods(this.currentIdx,t+1),o=s.goods.slice(0,t).map((t,s)=>(t.analiticsIndex=this.currentIdx+s,t));return this.currentIdx+=o.length,this.canShowMoreGoods=s.goods.length>t,{goods:o}},o._getGoods=async function(t,s){return this.nmIdsLoaded&&0==this.nms.length?{goods:[]}:this.goods.length>=t+s?{goods:this.goods.slice(t,t+s)}:this.nmIdsLoaded&&this.checkedNmCount>=this.nms.length?{goods:this.goods.slice(t,t+s),adv:[]}:this._loadGoods(t,s)},o._loadGoods=async function(t,s){if(!this.nmIdsLoaded)return await this._loadNmIds(),this._getGoods(t,s);let o;if(this.goodsChunksCache.has(this.currentChunk))o=this.goodsChunksCache.get(this.currentChunk);else{const t=this.nms.slice(this.checkedNmCount,this.checkedNmCount+this.chunkSize);this.checkedNmCount+=t.length,o=wb.xnm.getGoodsForRecommendAndCatalog(t),this.goodsChunksCache.set(this.currentChunk,o)}const e=await o;return null==e||e.forEach(t=>{var s;if(null!==(s=this.adverts)&&void 0!==s&&s.has(t.cod1S)){const s=this.adverts.get(t.cod1S);t.isAdv=!0,t.advertId=s.advertId,t.cpm=s.cpm}this.goods.push(t)}),this.currentChunk++,this._getGoods(t,s)},o._loadNmIds=async function(){try{var t,s,o,e;const n=null!==(t=await this._loadNmIdsAsync())&&void 0!==t?t:{};var i;if((null===(s=n.goods)||void 0===s?void 0:s.length)>0)(null===(i=n.nms)||void 0===i?void 0:i.length)>0||(n.nms=n.goods.map(t=>t.nmId));this.nms=null!==(o=n.nms)&&void 0!==o?o:[],this.goods=null!==(e=n.goods)&&void 0!==e?e:[],this.adverts=n.adverts}catch(t){console.error(t)}finally{this.nmIdsLoaded=!0}},o._loadNmIdsAsync=async function(){return this.settings.isSimilarByNm?this._loadSimilarByNm():t.prototype.loadGoodsAsync.call(this)},o._loadSimilarByNm=async function(){const t=await this.$analitic.getSplitterHeaders(),s=await this.$httpClient.fetchBasicJSON(`https://waterfall-card-rec.wildberries.ru/api/v1/recommendations?nm=${this.settings.query.nmId}`,{credentials:"omit",headers:t},{timeout:3e3,nullOnError:!0});if(!Array.isArray(s)||0===s.length)return null;const o=[],e=new Map;return s.forEach(t=>{o.push(t.nm),t.advertId&&t.cpm&&e.set(t.nm,t)}),{nms:o,adverts:e}},s}(t);module.exports={RecommendationsGoodsLoader:t,RecommendationsDynamicGoodsLoader:s}}();

},{}],3:[function(require,module,exports){
"use strict";function _defineProperties(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,_toPropertyKey(s.key),s)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}!function(){const{RecommendationsGoodsLoader:e,RecommendationsDynamicGoodsLoader:t}=require("./recommendationsGoodsLoader"),o=require("./recentGoodsLoader"),s=require("./recommendationsStat"),i=require("./recommendationsTagsLoader"),n={carousel:1,recentCarousel:2,recentItems:3,brandPreview:4,sellersCarousel:5};let r=function(r){function a(e,t={},o=n.carousel){var s,i;i=r.call(this)||this,"ICO"==t.analiticsCode&&(o=n.sellersCarousel);const a={loadWhenVisible:!0,imageSize:"c516x688",sliderSlr:".j-carousel",visibleCount:5,loop:!0,needDenom:!0,sameWindow:!0,beforeRouterTransition:i.beforeRouterTransition.bind(_assertThisInitialized(i)),type:o,recommendationsTypes:n,listMode:!1};return i.rootElement=e instanceof Element?e:document.querySelector(e),i.settings=i.$helper.deepMerge_v2({},a,t),null!==(s=wb.global.settings)&&void 0!==s&&null!==(s=s.switches)&&void 0!==s&&s.recommendedCardLikeCatalog&&(i.settings.showAddBasket=!0,i.settings.showSizes=!0,i.settings.showRating=!0,i.settings.showDelivery=!0),i.type=o,i.goodsLoader=null,i.recommendationsStat=null,i.types=n,i.destroy=i.destroy.bind(_assertThisInitialized(i)),i.refreshProductBtns=i.refreshProductBtns.bind(_assertThisInitialized(i)),i.showAsync=i.showAsync.bind(_assertThisInitialized(i)),i._bindEvents(),i}_inheritsLoose(a,r);var d=a.prototype;return d.destroy=function(){var e,t;this.observer&&this.observer.unobserve(this.rootElement),null===(e=this.cardsManager)||void 0===e||e.destroy(),null===(t=this.observerProduct)||void 0===t||t.destroy()},d.refreshProductBtns=function(){var e;null===(e=this.recommendations)||void 0===e||null===(e=e.goods)||void 0===e||e.forEach(e=>{$.observable(e).setProperty({addedToPoned:!1,addedToBasket:!1,addedToBooking:!1})})},d.showWhenInViewPortAsync=function(){if(this.$apiSupport.intersectionObserver)this.observer=new IntersectionObserver((e,t)=>{e.forEach(({isIntersecting:e,intersectionRatio:o})=>{(e||o>0)&&(this.showAsync(),t.unobserve(this.rootElement))})},{rootMargin:"100px"}),this.observer.observe(this.rootElement);else{const e=this.rootElement.getBoundingClientRect().top;document.documentElement.clientHeight>e?this.showAsync():(this._onScrollLoad=this.$helper.throttle(()=>{window.pageYOffset>=e-500&&(window.removeEventListener("scroll",this._onScrollLoad),this.showAsync())},300),window.addEventListener("scroll",this._onScrollLoad))}return this.observerProduct=WbSpaModel.prototype.$observerHelper.getVerticalObserver([],{keepObserve:!1,sendOutEvent:!1},{threshold:.8}),this},d.showAsync=async function(){try{"function"==typeof this.settings.onScrollTo&&this.settings.onScrollTo();const[t,[o]]=await Promise.all([this._loadGoodsAsync(),this._loadRequiredModules()]);if(!t||!t.goods||!t.goods.length)return this;if(this.settings.fillPrices){var e;const o=await(null===(e=this.goodsLoader)||void 0===e?void 0:e.fillGoodsAsync(t.nms,t.goods));if(!o||!o.length)return this;t.goods=o}(this.type!=this.types.carousel||this.settings.loadTagInfo)&&i.addRecommendationsTags(),this.recommendationsStat=new s(t,this.settings);const n=o.getCatalogCardBaseActionsBinderClass();return this.cardsManager=new n(t.goods,{cardSelector:".j-product-item",isCarouselCard:!0,targetUrl:this.settings.target||this.settings.targetUrl||"MI",onSlideMove:this._onPopupSlideMove.bind(this)}),this.cardsManager.analiticsData={onCardOpen:this.onCardOpen.bind(this)},this.cardsManager.init(),this._show(t),"function"==typeof this.settings.onCarouselShow&&this.settings.onCarouselShow.call(this),this}catch(e){return console.error(e.message),this}},d.onCardOpen=function(e){const t=e.currentTarget,{data:o}=$.view(t),s=this.settings.analiticsCode,i=o.analiticsIndex;if(s){const e={l:s,iid:(isNaN(i)?0:i)+1};var n,r;if(o.isAdv)e.t="",e.t1=null!==(n=o.advertId)&&void 0!==n?n:-1,e.t2=null!==(r=o.cpm)&&void 0!==r?r:-1,e.t3="";this.$analitic.saveState(e)}},d._show=async function(e){var t,o;this.recommendations=e;let s=this.$helper.deepMerge(this.cardsManager,e,this.settings);const i={all:!0,addToBasket:wb.global.settings.switches.recommendedCardLikeCatalog||this.settings.showAddBasket,addToPoned:wb.global.settings.switches.recommendedCardLikeCatalog||this.settings.showAddPonedBottom};if(s.dataLinkActions=this.cardsManager.getDataLinkActions("",i),s.listMode&&(s.showMoreBtn=this.goodsLoader.canShowMoreGoods,s.renderDynamicGoods=this.renderDynamicGoods.bind(this)),this.type==n.recentCarousel){const e={seeAllUrl:"/catalog/recent",showAllSeparate:!0};s=this.$helper.deepMerge(s,e)}this.model=s,this.cardsManager.analiticsData=this.recommendationsStat.getAnaliticsData(),this.template.link(this.rootElement,this.model),null===(t=this.rootElement.querySelector(".j-b-slider-wrapper"))||void 0===t||t.classList.remove("hide"),this.settings.sendStats&&this.recommendationsStat.statsSendShow(),this.recommendationsStat.showCarouselWba(),(this.settings.listMode||this.settings.needSendViewItemListStateWba)&&this.recommendationsStat.sendViewItemListStateWba(this.model.goods);const r=this.rootElement.querySelectorAll(".j-product-item");null===(o=this.observerProduct)||void 0===o||o.update(r),await this.$helper.nextTick(),this.rootElement.dispatchEvent(new CustomEvent("RecommendationCarouselRendered",{bubbles:!0}))},d._loadRequiredModules=async function(){return Promise.all([this.$moduleLoader.loadModuleAsync("catalogCore"),this.$moduleLoader.loadModuleAsync("swiper",!0)])},d._loadGoodsAsync=async function(){var s;return this.type==n.brandPreview?{goods:null===(s=this.settings)||void 0===s?void 0:s.products}:(this.settings.listMode?this.goodsLoader=new t(this.settings,{sizeForStaticGoods:35,sizeForDynamicGoods:35}):this.type==n.recentCarousel?this.goodsLoader=new o(this.settings):this.goodsLoader=new e(this.settings),this.goodsLoader.loadGoodsAsync())},d._bindEvents=function(){this.rootElement.addEventListener("click",this.$helper.delegator("a",(e,t)=>{!!t.dataset.seeAll&&(this.recommendationsStat.clickCarouselWba(t,null),this.settings.isPromo&&sessionStorage.putObject("promogoods_for_KT",this.recommendations.goods))})),window.addEventListener("spaTransition",this.refreshProductBtns),this.$eventBus.addEventListener("GeoUpdated",this.showAsync)},d._unbindEvents=function(){window.removeEventListener("scroll",this._onScrollLoad),window.removeEventListener("spaTransition",this.refreshProductBtns),this.$eventBus.removeEventListener("GeoUpdated",this.showAsync)},d._onPopupSlideMove=function(e){this.settings.sendStats&&this._statsSendClick(e),this.settings.sendStats&&this._statsSendShowByCards(e)},d.beforeRouterTransition=function(e){if(e.target.closest(".j-open-product-popup")||e.originalEvent.defaultPrevented)return!0;const{data:t}=$.view(e.currentTarget);if(null==t||t.isService)return!0;this.$services.productCard.stashCatalogProduct(t),e.preventDefault();const o=new URL(window.location.href);this.$router.replaceState(history.state,document.title,o.toString()),this.$adult.proceedIfAdultConfirmed(t.adult,this.$router.moveTo,this.$router,e.currentTarget.href)},d.renderDynamicGoods=async function(e){var t;const o=await this.goodsLoader.loadGoodsAsync();var s;(null==o||null===(t=o.goods)||void 0===t?void 0:t.length)>0&&($.observable(this.model.goods).insert(null!==(s=o.goods)&&void 0!==s?s:[]),this.recommendationsStat.sendViewItemListStateWba(o.goods),this.$helper.nextTick().then(()=>this.observerProduct.update(this.rootElement.querySelectorAll(".j-product-item"))));$.observable(this.model).setProperty("showMoreBtn",this.goodsLoader.canShowMoreGoods)},_createClass(a,[{key:"template",get:function(){return $.views.templates.recommendationsListTmpl}}],[{key:"recommendationsType",get:function(){return n}}]),a}(WbSpaModel);window.__spaModuleManager__.register("recommendationsList",r)}();

},{"./recentGoodsLoader":1,"./recommendationsGoodsLoader":2,"./recommendationsStat":4,"./recommendationsTagsLoader":5}],4:[function(require,module,exports){
"use strict";function _inheritsLoose(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t,_setPrototypeOf(t,s)}function _setPrototypeOf(t,s){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t})(t,s)}!function(){let t=function(t){function s(s,a={}){var e,r;return(r=t.call(this)||this).settings=a,r.goods=null!==(e=null==s?void 0:s.goods)&&void 0!==e?e:[],r.serviceCard=null==s?void 0:s.serviceCard,r}_inheritsLoose(s,t);var a=s.prototype;return a.getAnaliticsData=function(){if(this.settings.type==this.settings.recommendationsTypes.sellersCarousel){var t;const s=null!==(t=this.settings.analiticsData)&&void 0!==t?t:{};return s.lw="CR",s}return{onCardOpen:this.onCardOpen.bind(this),onCardClick:this.onCardClick.bind(this),onCardShow:this.onCardShow.bind(this),lw:"CR"}},a.onCardClick=function(t){const s=t.currentTarget,a=s.closest(".j-product-item"),{data:e}=$.view(a);this._updateAnalitics(a,e),this.clickCarouselWba(s,a),this.settings.sendStats&&this.statsSendClick(a.dataset.popupNmId,a.dataset.analiticsIid,e)},a.onCardShow=function(t,s){if(!this.settings.sendStats||!s)return;let a=[];2===s.advertId?(a.push(wb.stat.wrapParam("PARAM1",this.settings.productId)),a.push(wb.stat.wrapParam("PARAM2",s.advertId)),a.push(wb.stat.wrapParam("PARAM3",s.nmId)),a.push(wb.stat.wrapParam("PARAM4",t.dataset.analiticsIid)),a.push(wb.stat.wrapParam("PARAM5",s.cpm)),a.push(wb.stat.wrapParam("PARAM6",s.subjectId)),wb.stat.sendEvent("ACARS",a)):(a.push(wb.stat.wrapParam("C1S",this.settings.productId)),a.push(wb.stat.wrapParam("ADID",s.advertId)),a.push(wb.stat.wrapParam("NMID",s.nmId)),a.push(wb.stat.wrapParam("POS",t.dataset.analiticsIid)),a.push(wb.stat.wrapParam("CPM",s.cpm)),a.push(wb.stat.wrapParam("SID",s.subjectId)),a.push(wb.stat.wrapParam("BRID",s.brandCod)),wb.stat.sendEvent("APDS",a))},a.onCardOpen=function(t){this.settings.type!=this.settings.recommendationsTypes.sellersCarousel&&this.onCardClick(t)},a._updateAnalitics=function(t,s){var a,e,r;if(!s)return;const i=null!==(a=t.dataset.analiticsCode)&&void 0!==a?a:this.settings.analiticsCode,n=null!==(e=parseInt(t.dataset.analiticsIid))&&void 0!==e?e:parseInt(null!==(r=t.dataset.cardIndex)&&void 0!==r?r:t.dataset.index)+1;if(i){var d,o;let t=null;if(null!==(d=this.settings)&&void 0!==d&&d.advertCarouselStatParams&&Array.isArray(this.settings.advertCarouselStatParams)){var u,p;const a=this.settings.advertCarouselStatParams.find(t=>t.nmId==s.nmId);t={t:this.settings.productId,t1:null!==(u=a.advertId)&&void 0!==u?u:-1,t2:null!==(p=a.cpm)&&void 0!==p?p:-1,t3:""}}else if(s.isAdv){var l,c;t={t:"",t1:null!==(l=s.advertId)&&void 0!==l?l:-1,t2:null!==(c=s.cpm)&&void 0!==c?c:-1,t3:""}}if(t){const s={l:i,iid:n,...t};this.$analitic.saveState(s)}else i&&this.$analitic.proceedAndSave(i,n,null,(null===(o=this.settings.analiticsData)||void 0===o?void 0:o.term)||"")}},a.sendViewItemListStateWba=function(t){const s=t.map((t,s)=>{var a;const e=[this.settings.analiticsCode,"","PP","",t.isAdv?t.advertId:"",t.isAdv?t.cpm:"",""];return{id:null===(a=t.nmId)||void 0===a?void 0:a.toString(),name:t.name,brand:t.brand,price:t.priceWithCouponAndDiscount,inListIndex:t.analiticsIndex+1,listName:e.join("|"),subjectId:t.subjectId,subjectParentId:t.subjectParentId,feedbacksCount:t.feedbacks,rating:t.reviewRating}}),a={page:1,link:window.location.origin,goods:t.length};this.$analitic.sendWbaEcomStat("view_item_list",s,a)},a.showCarouselWba=function(){if(this.settings.type==this.settings.recommendationsTypes.sellersCarousel)return;const t=this.goods.map(t=>t.nmId);this._sendCarouselWbaEvent("Carousel_S",this.settings.analiticsCode,0,t),this._sendServiceCardStat("S")},a.clickCarouselWba=function(t,s){var a;if(this.settings.type==this.settings.recommendationsTypes.sellersCarousel)return;const e=!!t.dataset.seeAll,r=e?"Carousel_All":"Carousel_T",i="true"==(null==s||null===(a=s.dataset)||void 0===a?void 0:a.isService);e?this._sendCarouselWbaEvent(r,this.settings.analiticsCode,0,0):this._sendCarouselWbaEvent(r,this.settings.analiticsCode,null==s?void 0:s.dataset.analiticsIid,null==s?void 0:s.dataset.popupNmId),i&&this._sendServiceCardStat("T")},a.statsSendClick=function(t,s,a){if(this.settings.type==this.settings.recommendationsTypes.sellersCarousel)return;let e=[];if(a){if(!a.advertId)return;2===a.advertId?(e.push(wb.stat.wrapParam("PARAM1",this.settings.productId)),e.push(wb.stat.wrapParam("PARAM2",a.advertId)),e.push(wb.stat.wrapParam("PARAM3",a.nmId)),e.push(wb.stat.wrapParam("PARAM4",s)),e.push(wb.stat.wrapParam("PARAM5",a.cpm)),e.push(wb.stat.wrapParam("PARAM6",a.subjectId)),wb.stat.sendEvent("ACARC",e,!0)):(e.push(wb.stat.wrapParam("C1S",this.settings.productId)),e.push(wb.stat.wrapParam("ADID",a.advertId)),e.push(wb.stat.wrapParam("NMID",a.nmId)),e.push(wb.stat.wrapParam("POS",s)),e.push(wb.stat.wrapParam("CPM",a.cpm)),e.push(wb.stat.wrapParam("SID",a.subjectId)),e.push(wb.stat.wrapParam("BRID",a.brandCod)),wb.stat.sendEvent("APDC",e,!0))}else if(this.settings.advertCarouselStatParams){let s=this.settings.advertCarouselStatParams.filter(s=>s.nmId==t);if(!s||0==s.length)return;s=s[0],e.push(wb.stat.wrapParam("C1S",this.settings.productId)),e.push(wb.stat.wrapParam("ADID",s.advertId)),e.push(wb.stat.wrapParam("NMID",t)),e.push(wb.stat.wrapParam("POS",s.position)),e.push(wb.stat.wrapParam("CPM",s.cpm)),e.push(wb.stat.wrapParam("SID",s.subjectId)),e.push(wb.stat.wrapParam("BRID",s.brandId)),wb.stat.sendEvent("APDC",e,!0)}else e.push(wb.stat.wrapParam("ADID",this.settings.advertisementId)),e.push(wb.stat.wrapParam("NMID",t)),wb.stat.sendEvent("ACC",e)},a.statsSendShow=function(){if(this.settings.type==this.settings.recommendationsTypes.sellersCarousel)return;let t=[];this.settings.advertCarouselStatParams?this.statsSendShowByCards():(t.push(wb.stat.wrapParam("ADID",this.settings.advertisementId)),wb.stat.sendEvent("ACS",t))},a.statsSendShowByCards=function(t){var s;if(this.settings.type==this.settings.recommendationsTypes.sellersCarousel)return;if(!this.settings.advertCarouselStatParams||0==this.settings.advertCarouselStatParams.lenght)return;const a=document.querySelector(".j-adv-carousel-wrapper");let e=null==a||null===(s=a.querySelectorAll(".j-product-item:not(.j-shown-stat-sended)"))||void 0===s?void 0:s.toArray();if(!e||0==e.length)return;const r=this.settings.productId,i=this.settings.advertCarouselStatParams;function n(t){let s=i.filter(s=>s.nmId==t);if(!s||0==s.length)return;s=s[0];let a=[];a.push(wb.stat.wrapParam("C1S",r)),a.push(wb.stat.wrapParam("ADID",s.advertId)),a.push(wb.stat.wrapParam("NMID",t)),a.push(wb.stat.wrapParam("POS",s.position)),a.push(wb.stat.wrapParam("CPM",s.cpm)),a.push(wb.stat.wrapParam("SID",s.subjectId)),a.push(wb.stat.wrapParam("BRID",s.brandId)),wb.stat.sendEvent("APDS",a)}if(t){let s=null;if(e.forEach(a=>{a.dataset.popupNmId!=t||(s=a)}),null==s)return;n(t),s.classList.add("j-shown-stat-sended")}else if(this.$apiSupport.intersectionObserver){const t={root:a,threshold:.5};this.advCardsObserver=new IntersectionObserver((t,s)=>{t.forEach(t=>{if(t.isIntersecting){if(s.unobserve(t.target),t.target.classList.contains("j-shown-stat-sended"))return;n(t.target.dataset.popupNmId),t.target.classList.add("j-shown-stat-sended")}})},t),e.forEach(t=>{this.advCardsObserver.observe(t)})}else e.forEach(t=>{n(t.dataset.popupNmId),t.classList.add("j-shown-stat-sended")})},a._sendCarouselWbaEvent=function(t,s,a,e){this.$analitic.sendCarouselWbaEvent(t,s,a,e,0)},a._sendServiceCardStat=function(t){this.serviceCard&&t&&this.$analitic.sendEvent(`Item_Services_${t.toUpperCase()}`,{name:this.serviceCard.name,link:this.serviceCard.link,price:this.serviceCard.priceWithCouponAndDiscount})},s}(WbSpaModel);module.exports=t}();

},{}],5:[function(require,module,exports){
"use strict";function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}!function(){let e=function(e){function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.addRecommendationsTags=function(){$.views&&$.views.tags({swiperRecommendationCarousel:{recommendationsBreakpointMap:{full:{1024:{spaceBetween:30,slidesPerGroup:5},1310:{spaceBetween:30,slidesPerGroup:6},1520:{spaceBetween:30,slidesPerGroup:7}},light:{1024:{spaceBetween:30,slidesPerGroup:3},1120:{spaceBetween:30,slidesPerGroup:4},1360:{spaceBetween:30,slidesPerGroup:5}}},init(){this.options=this.tagCtx.props,this.swiper=null},onUpdate:!1,async onAfterLink(){await this.ctx.root.$helper.nextTick();const e=this.ctx.root.$apiSupport.nativeLazyImage;this.swiper=new Swiper(this.linkCtx.elem.querySelector(".j-carousel .swiper-container"),{slidesPerView:"auto",spaceBetween:8,watchOverflow:"true",watchSlidesProgress:!e,watchSlidesVisibility:!e,lazy:!e&&{loadPrevNextAmount:5,loadOnTransitionStart:!0},navigation:{nextEl:this.linkCtx.elem.querySelector(".j-carousel .swiper-button-next"),prevEl:this.linkCtx.elem.querySelector(".j-carousel .swiper-button-prev")},breakpoints:this.linkCtx.data.useLight?this.recommendationsBreakpointMap.light:this.recommendationsBreakpointMap.full,on:{imagesReady:()=>{e&&this.linkCtx.elem.querySelectorAll("img[data-src]").forEach(e=>{e.setAttribute("loading","lazy"),e.src=e.dataset.src})}},threshold:this.options.swiperThreshold})},onUnbind(){var e;null===(e=this.swiper)||void 0===e||e.destroy()}},nativeRecommendationCarousel:{init(){this.lazyLoader=null},async onAfterLink(){const e=await this.ctx.root.$moduleLoader.loadModuleAsync("lazyImageLoader");this.lazyLoader=new e(this.linkCtx.elem,{rootMargin:"0px 500px",root:this.linkCtx.elem})},onUnbind(){var e;null===(e=this.lazyLoader)||void 0===e||e.destroy()}}})},t}(WbSpaModel);module.exports=e}();

},{}]},{},[3]);
