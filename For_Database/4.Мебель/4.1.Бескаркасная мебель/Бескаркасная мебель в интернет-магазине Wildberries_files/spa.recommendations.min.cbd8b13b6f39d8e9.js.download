(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";$.views&&$.views.tags({recommendations:{dataBoundOnly:!0,mainElement:".j-b-recommended-goods-wrapper",displayElement:".j-b-recommended-goods-wrapper",template:'<div class="j-b-recommended-goods-wrapper"></div>',onUpdate:!1,getOptions:function(){var t,e,s,o;let i={type:this.tagCtx.props.type,markupBlock:this.tagCtx.props.markupBlock,nmIds:this.tagCtx.props.nmIds,products:this.tagCtx.props.goods,title:this.tagCtx.props.title,isFinishLook:this.tagCtx.props.isFinishLook,fillPrices:this.tagCtx.props.fillPrices,loop:!!this.tagCtx.props.hasOwnProperty("circular")&&this.tagCtx.props.circular,slideMoveMode:null!==(t=this.tagCtx.props.slideMoveMode)&&void 0!==t?t:"visible",needDenom:null===(e=this.tagCtx.props.needDenom)||void 0===e||e,seeAllUrl:this.tagCtx.props.seeAllUrl,sameWindow:null===(s=this.tagCtx.props.sameWindow)||void 0===s||s,fetchUrl:this.tagCtx.props.fetchUrl,isSimilarByNm:this.tagCtx.props.isSimilarByNm,isSimilarByRecent:this.tagCtx.props.isSimilarByRecent,isRecommendedByNm:this.tagCtx.props.isRecommendedByNm,isAlsoBuyByNm:this.tagCtx.props.isAlsoBuyByNm,analiticsCode:this.tagCtx.props.analiticsCode,analiticsData:this.tagCtx.props.analiticsData,loadItemsCustom:this.tagCtx.props.loadItemsCustom,onCarouselShow:this.tagCtx.props.onCarouselShow,onScrollTo:this.tagCtx.props.onScrollTo,onlyPopup:this.tagCtx.props.onlyPopup,popupDisableFullButton:this.tagCtx.props.popupDisableFullButton,showRating:this.tagCtx.props.showRating,showRatingNull:this.tagCtx.props.showRatingNull,showDelivery:this.tagCtx.props.showDelivery,showButtons:this.tagCtx.props.showButtons,showButtonBasket:this.tagCtx.props.showButtonBasket,onVoteClick:this.tagCtx.props.onVoteClick,onSeeAllClick:this.tagCtx.props.onSeeAllClick,onBasketClick:this.tagCtx.props.onBasketClick,onPonedClick:this.tagCtx.props.onPonedClick,updateAnalytics:this.tagCtx.props.updateAnalytics,swiperThreshold:this.tagCtx.props.swiperThreshold,showAllSeparate:null!==(o=this.tagCtx.props.showAllSeparate)&&void 0!==o&&o,userInfo:this.tagCtx.props.userInfo,seeAllDisabled:this.tagCtx.props.seeAllDisabled,httpMethod:this.tagCtx.props.httpMethod,noProcessResponse:this.tagCtx.props.noProcessResponse,xData:this.tagCtx.props.xData,useLight:this.tagCtx.props.useLight,showAddBasket:this.tagCtx.props.showAddBasket,showAddPonedBottom:this.tagCtx.props.showAddPonedBottom,showSizes:this.tagCtx.props.showSizes,listMode:this.tagCtx.props.listMode,sendStats:this.tagCtx.props.sendStats,productId:this.tagCtx.props.productId};this.tagCtx.props.visible&&(i.visibleCount=this.tagCtx.props.visible),this.tagCtx.props.cod1S&&(i.cod1S=this.tagCtx.props.cod1S),this.tagCtx.props.targetUrl&&(i.target=this.tagCtx.props.targetUrl);const n={};for(const t in this.tagCtx.props)this.tagCtx.props.hasOwnProperty(t)&&0===t.indexOf("query_")&&(n[t.split("query_")[1]]=this.tagCtx.props[t]);return i.query=n,i},init:function(){if(!this.inited)return this.inited=!0,this.ctx.root.$moduleLoader.loadModuleAsync("recommendationsList",!1).then((t,e)=>{const s=this.getOptions();this.recommendationsCarousel=new t(this.mainElem[0],s).showWhenInViewPortAsync()})},onUnbind:function(){var t;null===(t=this.recommendationsCarousel)||void 0===t||t.destroy()}},basketRecommendations:{baseTag:"recommendations",init:function(t){if(!t.props.enabled)return;const e=this,s=t.props.nmIds.join(",");let o=[];const i=t=>{this.ctx.root.$analitic.sendEvent(t,{cart_id:o.join(","),parent_id:s})};t.props.swiperThreshold=24,t.props.loadItemsCustom=(async t=>{if(void 0===t.nmIds||0===t.nmIds.length)return null;const e=new(await this.ctx.root.$moduleLoader.loadModuleAsync("basketRecommendationService"))({userInfo:t.userInfo}),s=o=await e.get(t.nmIds);return 0===s.length?{goods:[]}:{goods:(await wb.xnm.getGoodsForRecommendAndCatalog(s,!0,!0)).filter(t=>!t.soldOut)}}),t.props.onVoteClick=function(t){if("m"==wb.settings.displayMode)return;const e=JSON.parse(t.target.dataset.like);i(e?"Cart_Carousel_Recommendations_Like":"Cart_Carousel_Recommendations_Dislike"),$.observable(this).setProperty("voted",!0)},t.props.updateAnalytics=function(t){const{data:o}=$.view(t.target),i=this.goods.findIndex(t=>t==o)+1,n=this.analiticsCode;e.ctx.root.$analitic.updateState({iid:i,extraL:n,t:s})}},onAfterLink:async function(){const t=this;function e(e){e&&t.bindResize()}const s=await this.ctx.root.$moduleLoader.loadModuleAsync("recommendationsList",!1),o=this.getOptions();o.showAddBasket=!0,o.showAddPonedBottom=!wb.global.settings.switches.recommendedCardLikeCatalog,o.onlyPopup=!0,o.popupDisableFullButton=!0,o.onCarouselShow=e,o.getAddToBasketOpts=function(){const t=document.querySelector(".j-basket-form__content"),e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,s=t.scrollHeight;let o;return{basketCustomEvent:function(){const i=t.scrollHeight-s;document.documentElement.scrollTop=e+i;const n=document.querySelector(".popup-list-of-sizes");n&&(o=o||n.offsetTop,n.style.top=`${o+i}px`)}}},this.recommendationsCarousel=new s(this.mainElem[0],o).showWhenInViewPortAsync(e)},bindResize:function(){"m"==wb.settings.displayMode&&(this._onResize=this.ctx.root.$helper.throttle(()=>{const t=this.mainElem[0].querySelector(".goods-slider__list");if(!t)return;const{data:e}=$.view(t);t.scrollWidth>t.clientWidth?$.observable(e).setProperty({seeAllDisabled:!1}):$.observable(e).setProperty({seeAllDisabled:!0})},300),window.addEventListener("resize",this._onResize),this._onResize())},onUnbind:function(){var t,e;null===(t=this.recommendationsCarousel)||void 0===t||t.destroy(),window.removeEventListener("resize",this._onResize),null===(e=this.recommendationsCarousel)||void 0===e||e.destroy()}},promotions:{dataBoundOnly:!0,mainElement:".j-b-recommended-goods-wrapper",displayElement:".j-b-recommended-goods-wrapper",template:'<div class="j-b-recommended-goods-wrapper"></div>',onUpdate:!1,init:function(){if(!this.inited)return this.inited=!0,(this.ctx.root.$moduleLoader||this.ctx.root.router.$moduleLoader).loadModuleAsync("recommendationsList").then((t,e)=>{var s,o;let i={title:this.tagCtx.props.title,isPromo:!0,sendStats:!0,loop:!1,slideMoveMode:this.tagCtx.props.slideMoveMode,seeAllUrl:this.tagCtx.props.seeAllUrl,sameWindow:null===(s=this.tagCtx.props.sameWindow)||void 0===s||s,fetchUrl:this.tagCtx.props.fetchUrl,analiticsCode:this.tagCtx.props.analiticsCode,showAllSeparate:null!==(o=this.tagCtx.props.showAllSeparate)&&void 0!==o&&o,httpMethod:this.tagCtx.props.httpMethod};this.tagCtx.props.visible&&(i.visibleCount=this.tagCtx.props.visible),this.tagCtx.props.targetUrl&&(i.target=this.tagCtx.props.targetUrl);const n={};for(const t in this.tagCtx.props)this.tagCtx.props.hasOwnProperty(t)&&0===t.indexOf("query_")&&(n[t.split("query_")[1]]=this.tagCtx.props[t]);i.query=n,this.recommendationsCarousel=new t(this.mainElem[0],i).showWhenInViewPortAsync()})},onUnbind:function(){var t;null===(t=this.recommendationsCarousel)||void 0===t||t.destroy()}},swiperRecommendationCarousel:{recommendationsBreakpointMap:{full:{1024:{spaceBetween:30,slidesPerGroup:5},1310:{spaceBetween:30,slidesPerGroup:6},1520:{spaceBetween:30,slidesPerGroup:7}},light:{1024:{spaceBetween:30,slidesPerGroup:3},1120:{spaceBetween:30,slidesPerGroup:4},1360:{spaceBetween:30,slidesPerGroup:5}}},init(){this.options=this.tagCtx.props,this.swiper=null},onUpdate:!1,async onAfterLink(){await this.ctx.root.$helper.nextTick();const t=this.ctx.root.$apiSupport.nativeLazyImage;this.swiper=new Swiper(this.linkCtx.elem.querySelector(".j-carousel .swiper-container"),{slidesPerView:"auto",spaceBetween:8,watchOverflow:"true",watchSlidesProgress:!t,watchSlidesVisibility:!t,lazy:!t&&{loadPrevNextAmount:5,loadOnTransitionStart:!0},navigation:{nextEl:this.linkCtx.elem.querySelector(".j-carousel .swiper-button-next"),prevEl:this.linkCtx.elem.querySelector(".j-carousel .swiper-button-prev")},breakpoints:this.linkCtx.data.useLight?this.recommendationsBreakpointMap.light:this.recommendationsBreakpointMap.full,on:{imagesReady:()=>{t&&this.linkCtx.elem.querySelectorAll("img[data-src]").forEach(t=>{t.setAttribute("loading","lazy"),t.src=t.dataset.src})}},threshold:this.options.swiperThreshold})},onUnbind(){var t;null===(t=this.swiper)||void 0===t||t.destroy()}},nativeRecommendationCarousel:{init(){this.lazyLoader=null},async onAfterLink(){const t=await this.ctx.root.$moduleLoader.loadModuleAsync("lazyImageLoader");this.lazyLoader=new t(this.linkCtx.elem,{rootMargin:"0px 500px",root:this.linkCtx.elem})},onUnbind(){var t;null===(t=this.lazyLoader)||void 0===t||t.destroy()}}});

},{}]},{},[1]);
