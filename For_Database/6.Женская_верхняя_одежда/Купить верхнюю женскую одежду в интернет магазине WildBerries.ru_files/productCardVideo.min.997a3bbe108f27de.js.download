(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";!function(){let e=function(){function e(e,t,i,s){this.videoSelector=e,this.parentId=t,this.nmId=i.nmId,this.hasVideo=i.hasVideo,this.video=null,this.inited=!1,this.adultOnly=null!=s&&s,this.isPause=!1,this.needUpdate=!1,this.videoSrc=this.hasVideo?this._getVideoUrl(this.nmId):null,this.posterLink.depends=["nmId"],this._onPlayCallback=this._onPlayCallback.bind(this),this._onPauseCallback=this._onPauseCallback.bind(this),this.onColorChanged=this.onColorChanged.bind(this),this.onProductChanged=this.onProductChanged.bind(this)}var t=e.prototype;return t.posterLink=function(){return $.views.helpers.ImageUrl(this.nmId,"big",1)},t.init=function(){return this._bindEvents(),this},t.destroy=function(){this._unbindEvents()},t.onColorChanged=function(e){const{sourceId:t,sourceNmId:i,selectedNomenclature:s}=e.detail;t==this.parentId&&this.nmId==i&&($.observable(this).setProperty({nmId:s.nmId,hasVideo:s.hasVideo,videoSrc:s.hasVideo?this._getVideoUrl(s.nmId):null}),this.reset())},t.onProductChanged=function(e){const{sourceId:t,sourceNmId:i,selectedNomenclature:s,product:n}=e.detail;t==this.parentId&&this.nmId==i&&($.observable(this).setProperty({nmId:s.nmId,hasVideo:s.hasVideo,adultOnly:n.adult,videoSrc:s.hasVideo?this._getVideoUrl(s.nmId):null}),this.reset())},t.show=function(){this.inited||this._init(),this.video.play()},t.reset=function(){var e;null===(e=this.video)||void 0===e||e.pause(),$.observable(this).setProperty({isPause:!1,inited:!1})},t.update=function(e){this.selectedNomenclature=e,$.observable(this).setProperty({videoSrc:this.hasVideo?this._getVideoUrl(this.nmId)+".mp4":null})},t.pause=function(){var e;null===(e=this.video)||void 0===e||e.pause(),$.observable(this).setProperty({isPause:!1})},t._init=function(){this.video=document.querySelector(this.videoSelector),this.video.addEventListener("play",this._onPlayCallback),this.video.addEventListener("pause",this._onPauseCallback),this.inited=!0},t._onPlayCallback=function(){$.observable(this).setProperty({isPause:!1}),this.adultOnly&&!this.$adult.isConfirmed&&this.video.pause(),this.$adult.proceedIfAdultConfirmed(this.adultOnly,()=>this.video.play(),this)},t._onPauseCallback=function(){$.observable(this).setProperty({isPause:!0})},t._getVideoUrl=function(e){var t=1e4*Math.floor(e/1e4);return String.format("{0}new/{1}/{2}.mp4",wb.settings.videoPath,t,e)},t._bindEvents=function(){this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onProductChanged)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onProductChanged)},e}();window.__spaModuleManager__.register("productCardVideo",e)}();

},{}]},{},[1]);
