!function(i){"use strict";i.views&&i.views.tags({contextMenu:{baseTag:"on",init:function(t){var e=t.args;t.args=["contextmenu",...e,this.onContextMenu.bind(this)],this.baseApply(arguments),this._destroyMenu=this._destroyMenu.bind(this)},onContextMenu:function(t){var e,n;t.preventDefault(),t.target.closest(".context-menu")||({data:e,ctx:n}=i.view(t.target),this._destroyMenu(),this.contextMenu=document.createElement("div"),this.contextMenu.classList.add("context-menu"),this.tagCtx.tmpl?this.tagCtx.tmpl.link(this.contextMenu,e,n):this.contextMenu.innerHTML="empty context menu",this.lastElement={target:t.currentTarget,data:e},t.currentTarget.appendChild(this.contextMenu),i.observable(e).setProperty("activeMenu",!0),document.addEventListener("click",this),n=t.target.closest(".j-context-outer").getBoundingClientRect(),(t=(e=this.contextMenu.querySelector(".j-context-content")).getBoundingClientRect()).right>=n.right-20&&(n=n.right-t.right-20,t=+getComputedStyle(e).left.replace("px",""),e.style.left=t+n+"px"))},handleEvent:function(t){"click"!=t.type&&!this.contextMenu||t.target.offsetParent==this.contextMenu||(this._destroyMenu(),document.removeEventListener("click",this))},_destroyMenu:function(){var{target:t,data:e}=this.lastElement||{};t&&t.removeChild(this.contextMenu),e&&i.observable(e).setProperty("activeMenu",!1),this.contextMenu=null,this.lastElement=null},onUnbind:function(){this.baseApply(arguments),this._destroyMenu(),document.removeEventListener("click",this)}}})}(this.jQuery);