(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(){let e=function(){function e(e,t,i,o,s,n){var r;this.id=this.$generateGuid(),this.parentId=e,this.nmId=t.nmId,this.enabledForRegion=t.enabledForRegion,this.isImport=t.isImport,this.hasVideo=null!==(r=t.hasVideo)&&void 0!==r&&r,this.picsCount=t.picsCount,this.urlForReccomendations=t.urlForReccomendations,this.delta=this.hasVideo,this.totalSlides=this.picsCount+this.delta,this.adult=t.adult,this.goodsName=t.goodsName,this.brandName=t.brandName,this.catalogLink="",this.deliveryModel=o,this.ponedModel=i,this.videoModel=s,this.statsModel=n,this.currentSlide=0+this.delta,this.imageGaleryShow=!1,this.shouldShowVideo.depends=["nmId","currentSlide","delta"],this.updateCurrentSlide=this.updateCurrentSlide.bind(this),this.onColorChanged=this.onColorChanged.bind(this)}var t=e.prototype;return t.shouldShowVideo=function(){return this.hasVideo&&this.currentSlide-this.delta==-1||this.currentSlide-this.delta==-2},t.init=function(){return this._bindEvents(),this},t.destroy=function(){this._unbindEvents(),this.videoModel.destroy(),this.ponedModel.destroy()},t.onColorChanged=function(e){var t;const{isDetailsLoaded:i,sourceId:o,sourceNmId:s,selectedNomenclature:n,product:r}=e.detail;if(o!=this.parentId||s!=this.nmId)return;const a=null!==(t=n.hasVideo)&&void 0!==t&&t;!a&&i&&this.nmId===n.nmId||($.observable(this).setProperty({nmId:n.nmId,enabledForRegion:n.enabledForRegion,isImport:n.isImport,hasVideo:n.hasVideo,picsCount:n.picsCount,urlForReccomendations:n.urlForReccomendations,currentSlide:0+a,delta:a,totalSlides:n.picsCount+a,adult:n.adult,goodsName:n.goodsName,brandName:n.brandName}),this.$helper.animationFrameWithMinDelay(50,()=>this.initCarousel()))},t.initCarousel=function(){var e,t;const i=document.getElementById(this.id);if(!i)return;if(this.imageCarousel)return 0!==this.imageCarousel.activeIndex&&this.imageCarousel.slideTo(0),this.imageCarousel.update();const o=i.querySelector(".j-sw-images-carousel");null===(e=this.imageCarousel)||void 0===e||e.destroy();const s={slidesPerView:"auto",centeredSlides:!1,spaceBetween:0,watchOverflow:!0,minRatio:1,maxRatio:2,pagination:{el:i.querySelector(".j-pagination"),type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span>/<span class="'+t+'"></span>'}},navigation:{prevEl:i.querySelector(".swiper-button-prev"),nextEl:i.querySelector(".swiper-button-next"),disabledClass:"disabled",lockClass:"hide"},breakpoints:{576:{direction:"horizontal",centeredSlides:!0,slidesPerView:"auto",spaceBetween:24},1024:{direction:"vertical",centeredSlides:!1,slidesPerView:5,spaceBetween:8},1600:{direction:"vertical",centeredSlides:!1,slidesPerView:"auto",spaceBetween:8}},on:{init:()=>{o.classList.remove("carousel-opacity")},beforeTransitionStart:()=>{var e;this.hasVideo&&(null===(e=o.querySelector(".j-wb-video-player"))||void 0===e||e.pause())},click:e=>{var t;if(this.$isDesktop)return;if(null!=e.target.closest(".j-find-similar"))return;const i=e.target.closest(".swiper-slide");null!=i&&i.classList.contains("slide--video")||this.$adult.proceedIfAdultConfirmed(this.adult,this.showImageGallery,this,parseInt(null!==(t=i.dataset.imageIndex)&&void 0!==t?t:0),e)}}};null!==(t=wb.global.settings)&&void 0!==t&&null!==(t=t.switches)&&void 0!==t&&t.enableLazyProductSwiper&&(s.lazy={loadPrevNext:!0,loadPrevNextAmount:3}),this.imageCarousel=new Swiper(o,s)},t.updateCurrentSlide=function(e){var t,i,o;this.currentSlide!=e&&(e>=0&&(null===(t=this.statsModel)||void 0===t||t.sendEvent("Item_Photo_S",{index:e+1})),-2==e&&(null===(i=this.statsModel)||void 0===i||i.sendEvent("Item_Video_Icon_T")),$.observable(this).setProperty({currentSlide:e}),this.shouldShowVideo()?this.videoModel.show():null===(o=this.videoModel.video)||void 0===o||o.pause())},t.showSocialSharePopup=function(){this.$moduleLoader.loadModuleAsync("productShareHelper").then(e=>{e.showSocialSharePopup(this.nmId,this.goodsName,this.brandName)})},t.moveToNextSlide=function(){const e=(this.currentSlide+1)%this.totalSlides;this.updateCurrentSlide(e),this.imageCarousel.slideTo(e)},t.moveToPreviousSlide=function(){const e=(this.currentSlide-1+this.totalSlides)%this.totalSlides;this.updateCurrentSlide(e),this.imageCarousel.slideTo(e)},t.slideToVideo=function(){if(!this.hasVideo)return;const e=this.picsCount-1+this.delta;this.imageCarousel.slideTo(e,120*Math.abs(this.imageCarousel.activeIndex-e))},t.showImageGallery=async function(e,t){if(!this.imageGaleryShow&&null==(null==t?void 0:t.target.closest(".j-find-similar"))){this.imageGaleryShow=!0;try{const i=this.$moduleLoader.loadModuleAsync("productGalleryViewer"),o=[],s=[];for(let e=0;e<this.picsCount;e++)o.push($.views.helpers.ImageUrl(this.nmId,"big",e+1)),s.push($.views.helpers.ImageUrl(this.nmId,"c246x328",e+1));(await i).showGallery(o,s,null!=e?e:this.currentSlide-this.delta,{classList:["goods-photo"],onHide:()=>this.imageGaleryShow=!1})}catch(t){console.error(t.message),this.imageGaleryShow=!1}}},t.stopVideo=function(){var e;null===(e=this.videoModel)||void 0===e||e.pause()},t._bindEvents=function(){this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onColorChanged)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onColorChanged)},_createClass(e,[{key:"template",get:function(){return e.template}}]),e}();window.__spaModuleManager__.register("productCardImageGallery",e)}();

},{}]},{},[1]);
