(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,_toPropertyKey(s.key),s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(){let e=function(){function e(e,t,i,s,o,n,d=!1){this.nmId=e.nmId,this.enabledForRegion=e.enabledForRegion,this.selectedSize=e.selectedSize,this.allSizesSoldOut=e.allSizesSoldOut,this.sizes=e.sizes,this.colorName=e.colorName,this.adult=e.adult,this.goodName=e.goodsName,this.brandName=e.brandName,this.subjectId=e.subjectId,this.subjectParentId=e.subjectParentId,this.sizeModel=i,this.priceModel=s,this.targetInfo=t,this.isAuth=o.isAuthenticated,this.isPopup=d,this.favedTrigger=Date.now(),this.analiticState=n,this.showAddToPoned.depends=["nmId","selectedSize","allSizesSoldOut","enabledForRegion"],this.isItemPoned.depends=["nmId","selectedSize","favedTrigger","$services.favsService^isSynced"],this.onSizeUpdated=this.onSizeUpdated.bind(this),this.onColorChanged=this.onColorChanged.bind(this),this.onProductChanged=this.onProductChanged.bind(this),this.onFavoritesUpdate=this.onFavoritesUpdate.bind(this)}var t=e.prototype;return t.isItemPoned=function(){var e;return!(null===(e=this.selectedSize)||void 0===e||!e.characteristicId||!this.$services.favsService.isSynced)&&this.$services.favsService.isAddedToFavs(this.selectedSize.characteristicId)},t.showAddToPoned=function(){var e,t;return this.enabledForRegion&&!this.allSizesSoldOut&&!(null!==(e=null===(t=this.selectedSize)||void 0===t?void 0:t.isSoldOut)&&void 0!==e&&e)},t.init=function(){return this._bindEvents(),this._checkFavs(),this},t.destroy=function(){return this._unbindEvents(),this},t.onSizeUpdated=function(e){const{nmId:t,selectedSize:i}=e.detail;if(this.nmId!=t)return;const s=this.sizes.find(e=>e.characteristicId==i);$.observable(this).setProperty({selectedSize:s})},t.onColorChanged=function(e){const{sourceNmId:t,selectedNomenclature:i}=e.detail;this.nmId==t&&($.observable(this).setProperty({nmId:i.nmId,enabledForRegion:i.enabledForRegion,selectedSize:i.selectedSize,allSizesSoldOut:i.allSizesSoldOut,adult:i.adult,goodName:i.goodsName,brandName:i.brandName,subjectId:i.subjectId,subjectParentId:i.subjectParentId,colorName:i.colorName}),this.sizes=i.sizes)},t.onProductChanged=function(e){const{sourceNmId:t,selectedNomenclature:i,product:s,targetInfo:o}=e.detail;this.nmId==t&&($.observable(this).setProperty({nmId:i.nmId,enabledForRegion:i.enabledForRegion,selectedSize:i.selectedSize,allSizesSoldOut:i.allSizesSoldOut,adult:i.adult,goodName:i.goodsName,brandName:i.brandName,subjectId:i.subjectId,subjectParentId:i.subjectParentId,targetInfo:o}),this.analiticState=this.$analitic.getState(),this.sizes=i.sizes)},t.onFavoritesUpdate=function(e){const{nmId:t,isPoned:i}=e.detail;t==this.nmId&&i&&$.observable(this).setProperty({favedTrigger:Date.now()})},t.togglePonedStatus=function(){if(this._togglePonedInProcess)return Promise.resolve(!1);if(this._togglePonedInProcess=!0,this.$isDesktop&&!this.sizeModel.validateSize())return this._togglePonedInProcess=!1,this.sizeModel.blinkSize(),Promise.resolve(!1);const e=this.isItemPoned();return Promise.all([this.$moduleLoader.loadModuleAsync("basketAdderHelper"),this.$moduleLoader.loadModuleAsync("basketAdderAdapter")]).then(([t,i])=>{var s,o;const n=new i(this,i.filterSizes(this.sizes,i.filterTypes.poned));return e?t.removeFromPoned(n):t.addToPoned(n,{targetUrl:null===(s=this.targetInfo)||void 0===s?void 0:s.targetUrl,targetCode:null===(o=this.targetInfo)||void 0===o?void 0:o.targetCode,lw:this.isPopup?"IP":"IT",...this.analiticState})}).finally(()=>{this._togglePonedInProcess=!1})},t._checkFavs=function(){this.isAuth&&this.$services.favsService.syncFromServerAsync()},t._bindEvents=function(){this.$eventBus.addEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onProductChanged),this.$eventBus.addEventListener("FavoriteGoodsUpdated",this.onFavoritesUpdate)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onProductChanged),this.$eventBus.removeEventListener("FavoriteGoodsUpdated",this.onFavoritesUpdate)},_createClass(e,[{key:"template",get:function(){return e.template}}]),e}();window.__spaModuleManager__.register("productCardPoned",e)}();

},{}]},{},[1]);
